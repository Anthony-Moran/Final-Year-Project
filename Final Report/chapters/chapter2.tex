\chapter{Methods}
\label{chapter2}

\section{Version Control}
All of the code developed for this project has been managed by git and pushed to a github respository with can be accessed by the link:

\begin{center}
    https://github.com/Anthony-Moran/Final-Year-Project
\end{center}

The history will show the various stages of this project and how we started off with a blank workspace and ended up with this product now.
When implementing the online features, the commit messages became less detailed because the changes were extremely minor and changes were being made rapidly for debugging the transition from offline to online.

Offline and online version, mention it here but explain more detail will be given in the backend section.

\section{Back End}

Processing logic on server side to reduce computation on client side and also means there is a single point of truth

\subsection{Chess Logic}

Mention transition from old chess engine to python-chess. The old version was going to be used when the project started off as machine learning but in the end it wasn't fully implemented so now we are using the built in chess module.

Board is represented using FEN.

\subsection{Game Management}

Storing a tuple of game state and connected users in a dictionary with join key\linebreak
Generating join keys

\subsection{Python Server}

Offline server, explain how to enact

\subsection{Github Pages}

Online server

\section{Communication}

Network speed - applicable to online version\linebreak
Consider security\linebreak
Bad join keys redirect users to home menu

Challenege with matching the backend board with the frontend representation: orientation of pieces vs canvas coordinates

\subsection{Websockets}
Code was adapted from https://websockets.readthedocs.io/en/stable/\linebreak
Flawed with short life time and disconnect easily\linebreak
Pro is that they use bidirectional channel, so polling is no longer required\linebreak
Iphone will disconnect if locked/leaves safari (added cheap fix to allow reconnection but it's not special to the user, anyone can connect in their place)\linebreak
Refreshing with one user would cause the game to be deleted because the server would temporarily see that there are no users in the game. And after the page refreshed the user wouldn't be able to join because the game is now deleted. Added a small buffer time to keep the game alive, to combat this.\linebreak

Closed after win because no more messages need to be exchanged.

\subsection{Heroku}

Platform as a service (distirbuted systems?)

Server sleeps after a period of not being used. Causes next request to take a few seconds longer than usual


\section{Front End}

\subsection{The Welcome Page}

Option to start a new game\linebreak
Alternatively you can enter a code and join an existing game

Red message appears under user input if they entered an invalid code. Catches the eye and red subconsciously indicates error.

\subsection{The Chess Page}

Nav bar to return to main menu\linebreak
Text at the top to show join code and link\linebreak
Also prompts on who's turn it is and whether user is in check or if the game has finished with the result.\linebreak
board is drawn with canvas

reference sprite sheet\linebreak
requires javascript\linebreak
interaction through mouse click events : converts mouse position to row and column using modolos (check spelling) and integer division\linebreak
only parts of the board that need updating are updated: only drawing pieces that have moved or been taken, more resource efficient than redrawing the whole board.

\subsection{Responsive Design}

(CSS) Prioritises mobile devices and forces computers to adjust the layout. Computers typically have faster processors than mobile devices.\linebreak
computer users can resize the window and the design adapts: https://web.archive.org/web/20220714020647/https://bencentra.com/code/2015/02/27/optimizing-window-resize.html (debouncing?)